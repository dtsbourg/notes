<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>TCP_IP_Networking_2_Network</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style type="text/css">
  @font-face {
    font-family: octicons-link;
    src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
  }
  
  body {
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
    color: #333;
    font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    font-size: 16px;
    line-height: 1.6;
    word-wrap: break-word;
    width: 728px;
    max-width: 99%;
    box-sizing: border-box;
    padding: 30px 30px 8rem 30px;
    margin-left: auto;
    margin-right: auto;
  }
  
  body a {
    background-color: transparent;
  }
  
  body a:active,
  body a:hover {
    outline: 0;
  }
  
  body strong {
    font-weight: bold;
  }
  
  body h1 {
    font-size: 2em;
    margin: 0.67em 0;
  }
  
  body img {
    border: 0;
  }
  
  body hr {
    box-sizing: content-box;
    height: 0;
  }
  
  body pre {
    overflow: auto;
  }
  
  body code,
  body kbd,
  body pre {
    font-family: monospace, monospace;
    font-size: 1em;
  }
  
  body input {
    color: inherit;
    font: inherit;
    margin: 0;
  }
  
  body html input[disabled] {
    cursor: default;
  }
  
  body input {
    line-height: normal;
  }
  
  body input[type="checkbox"] {
    box-sizing: border-box;
    padding: 0;
  }
  
  body table {
    border-collapse: collapse;
    border-spacing: 0;
  }
  
  body td,
  body th {
    padding: 0;
  }
  
  body * {
    box-sizing: border-box;
  }
  
  body input {
    font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  }
  
  body a {
    color: #4078c0;
    text-decoration: none;
  }
  
  body a:hover,
  body a:active {
    text-decoration: underline;
  }
  
  body hr {
    height: 0;
    margin: 15px 0;
    overflow: hidden;
    background: transparent;
    border: 0;
    border-bottom: 1px solid #ddd;
  }
  
  body hr:before {
    display: table;
    content: "";
  }
  
  body hr:after {
    display: table;
    clear: both;
    content: "";
  }
  
  body h1,
  body h2,
  body h3,
  body h4,
  body h5,
  body h6 {
    margin-top: 15px;
    margin-bottom: 15px;
    line-height: 1.1;
  }
  
  body h1 {
    font-size: 30px;
  }
  
  body h2 {
    font-size: 21px;
  }
  
  body h3 {
    font-size: 16px;
  }
  
  body h4 {
    font-size: 14px;
  }
  
  body h5 {
    font-size: 12px;
  }
  
  body h6 {
    font-size: 11px;
  }
  
  body blockquote {
    margin: 0;
  }
  
  body ul,
  body ol {
    padding: 0;
    margin-top: 0;
    margin-bottom: 0;
  }
  
  body ol ol,
  body ul ol {
    list-style-type: lower-roman;
  }
  
  body ul ul ol,
  body ul ol ol,
  body ol ul ol,
  body ol ol ol {
    list-style-type: lower-alpha;
  }
  
  body dd {
    margin-left: 0;
  }
  
  body code {
    font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
    font-size: 12px;
  }
  
  body pre {
    margin-top: 0;
    margin-bottom: 0;
    font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  }
  
  body .select::-ms-expand {
    opacity: 0;
  }
  
  body .octicon {
    font: normal normal normal 16px/1 octicons-link;
    display: inline-block;
    text-decoration: none;
    text-rendering: auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
  
  body .octicon-link:before {
    content: '\f05c';
  }
  
  body:before {
    display: table;
    content: "";
  }
  
  body:after {
    display: table;
    clear: both;
    content: "";
  }
  
  body>*:first-child {
    margin-top: 0 !important;
  }
  
  body>*:last-child {
    margin-bottom: 0 !important;
  }
  
  body a:not([href]) {
    color: inherit;
    text-decoration: none;
  }
  
  body .anchor {
    display: inline-block;
    padding-right: 2px;
    margin-left: -18px;
  }
  
  body .anchor:focus {
    outline: none;
  }
  
  body h1,
  body h2,
  body h3,
  body h4,
  body h5,
  body h6 {
    margin-top: 1em;
    margin-bottom: 16px;
    font-weight: bold;
    line-height: 1.4;
  }
  
  body h1 .octicon-link,
  body h2 .octicon-link,
  body h3 .octicon-link,
  body h4 .octicon-link,
  body h5 .octicon-link,
  body h6 .octicon-link {
    color: #000;
    vertical-align: middle;
    visibility: hidden;
  }
  
  body h1:hover .anchor,
  body h2:hover .anchor,
  body h3:hover .anchor,
  body h4:hover .anchor,
  body h5:hover .anchor,
  body h6:hover .anchor {
    text-decoration: none;
  }
  
  body h1:hover .anchor .octicon-link,
  body h2:hover .anchor .octicon-link,
  body h3:hover .anchor .octicon-link,
  body h4:hover .anchor .octicon-link,
  body h5:hover .anchor .octicon-link,
  body h6:hover .anchor .octicon-link {
    visibility: visible;
  }
  
  body h1 {
    padding-bottom: 0.3em;
    font-size: 1.75em;
    line-height: 1.2;
  }
  
  body h1 .anchor {
    line-height: 1;
  }
  
  body h2 {
    padding-bottom: 0.3em;
    font-size: 1.5em;
    line-height: 1.225;
  }
  
  body h2 .anchor {
    line-height: 1;
  }
  
  body h3 {
    font-size: 1.25em;
    line-height: 1.43;
  }
  
  body h3 .anchor {
    line-height: 1.2;
  }
  
  body h4 {
    font-size: 1em;
  }
  
  body h4 .anchor {
    line-height: 1.2;
  }
  
  body h5 {
    font-size: 1em;
  }
  
  body h5 .anchor {
    line-height: 1.1;
  }
  
  body h6 {
    font-size: 1em;
    color: #777;
  }
  
  body h6 .anchor {
    line-height: 1.1;
  }
  
  body p,
  body blockquote,
  body ul,
  body ol,
  body dl,
  body table,
  body pre {
    margin-top: 0;
    margin-bottom: 16px;
  }
  
  body hr {
    height: 4px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
  }
  
  body ul,
  body ol {
    padding-left: 2em;
  }
  
  body ul ul,
  body ul ol,
  body ol ol,
  body ol ul {
    margin-top: 0;
    margin-bottom: 0;
  }
  
  body li>p {
    margin-top: 16px;
  }
  
  body dl {
    padding: 0;
  }
  
  body dl dt {
    padding: 0;
    margin-top: 16px;
    font-size: 1em;
    font-style: italic;
    font-weight: bold;
  }
  
  body dl dd {
    padding: 0 16px;
    margin-bottom: 16px;
  }
  
  body blockquote {
    padding: 0 15px;
    color: #777;
    border-left: 4px solid #ddd;
  }
  
  body blockquote>:first-child {
    margin-top: 0;
  }
  
  body blockquote>:last-child {
    margin-bottom: 0;
  }
  
  body table {
    display: block;
    width: 100%;
    overflow: auto;
    word-break: normal;
    word-break: keep-all;
  }
  
  body table th {
    font-weight: bold;
  }
  
  body table th,
  body table td {
    padding: 6px 13px;
    border: 1px solid #ddd;
  }
  
  body table tr {
    background-color: #fff;
    border-top: 1px solid #ccc;
  }
  
  body table tr:nth-child(2n) {
    background-color: #f8f8f8;
  }
  
  body img {
    max-width: 100%;
    box-sizing: content-box;
    background-color: #fff;
  }
  
  body code {
    padding: 0;
    padding-top: 0;
    padding-bottom: 0;
    margin: 0;
    font-size: 85%;
    background-color: rgba(0,0,0,0.04);
    border-radius: 3px;
  }
  
  body code:before,
  body code:after {
    letter-spacing: -0.2em;
    content: "\00a0";
  }
  
  body pre>code {
    padding: 0;
    margin: 0;
    font-size: 100%;
    word-break: normal;
    white-space: pre;
    background: transparent;
    border: 0;
  }
  
  body .highlight {
    margin-bottom: 16px;
  }
  
  body .highlight pre,
  body pre {
    padding: 16px;
    overflow: auto;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border-radius: 3px;
  }
  
  body .highlight pre {
    margin-bottom: 0;
    word-break: normal;
  }
  
  body pre {
    word-wrap: normal;
  }
  
  body pre code {
    display: inline;
    max-width: initial;
    padding: 0;
    margin: 0;
    overflow: initial;
    line-height: inherit;
    word-wrap: normal;
    background-color: transparent;
    border: 0;
  }
  
  body pre code:before,
  body pre code:after {
    content: normal;
  }
  
  body kbd {
    display: inline-block;
    padding: 3px 5px;
    font-size: 11px;
    line-height: 10px;
    color: #555;
    vertical-align: middle;
    background-color: #fcfcfc;
    border: solid 1px #ccc;
    border-bottom-color: #bbb;
    border-radius: 3px;
    box-shadow: inset 0 -1px 0 #bbb;
  }
  
  body .pl-c {
    color: #969896;
  }
  
  body .pl-c1,
  body .pl-s .pl-v {
    color: #0086b3;
  }
  
  body .pl-e,
  body .pl-en {
    color: #795da3;
  }
  
  body .pl-s .pl-s1,
  body .pl-smi {
    color: #333;
  }
  
  body .pl-ent {
    color: #63a35c;
  }
  
  body .pl-k {
    color: #a71d5d;
  }
  
  body .pl-pds,
  body .pl-s,
  body .pl-s .pl-pse .pl-s1,
  body .pl-sr,
  body .pl-sr .pl-cce,
  body .pl-sr .pl-sra,
  body .pl-sr .pl-sre {
    color: #183691;
  }
  
  body .pl-v {
    color: #ed6a43;
  }
  
  body .pl-id {
    color: #b52a1d;
  }
  
  body .pl-ii {
    background-color: #b52a1d;
    color: #f8f8f8;
  }
  
  body .pl-sr .pl-cce {
    color: #63a35c;
    font-weight: bold;
  }
  
  body .pl-ml {
    color: #693a17;
  }
  
  body .pl-mh,
  body .pl-mh .pl-en,
  body .pl-ms {
    color: #1d3e81;
    font-weight: bold;
  }
  
  body .pl-mq {
    color: #008080;
  }
  
  body .pl-mi {
    color: #333;
    font-style: italic;
  }
  
  body .pl-mb {
    color: #333;
    font-weight: bold;
  }
  
  body .pl-md {
    background-color: #ffecec;
    color: #bd2c00;
  }
  
  body .pl-mi1 {
    background-color: #eaffea;
    color: #55a532;
  }
  
  body .pl-mdr {
    color: #795da3;
    font-weight: bold;
  }
  
  body .pl-mo {
    color: #1d3e81;
  }
  
  body kbd {
    display: inline-block;
    padding: 3px 5px;
    font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
    line-height: 10px;
    color: #555;
    vertical-align: middle;
    background-color: #fcfcfc;
    border: solid 1px #ccc;
    border-bottom-color: #bbb;
    border-radius: 3px;
    box-shadow: inset 0 -1px 0 #bbb;
  }
  
  body .task-list-item {
    list-style-type: none;
  }
  
  body .task-list-item+.task-list-item {
    margin-top: 3px;
  }
  
  body .task-list-item input {
    margin: 0 0.35em 0.25em -1.6em;
    vertical-align: middle;
  }
  
  body :checked+.radio-label {
    z-index: 1;
    position: relative;
    border-color: #4078c0;
  }
  </style>
</head>
<body>
<h1 id="tcpip-networking">TCP/IP Networking</h1>
<h2 id="the-network-layer">The network layer</h2>
<ul>
<li>Book : <em>Chapter 5</em></li>
<li>slides : <code>ip1.pdf</code>, <code>ip2.pdf</code></li>
</ul>
<h3 id="the-two-principles-of-ip-unicast">1. The Two Principles of IP Unicast</h3>
<p>(unicast = transmission to a single recipient)</p>
<ol type="1">
<li><p><u>Structured addresses + longest prefix match</u></p>
<p><em>This allows for hierarchical addressing.</em></p></li>
<li><p><u>Don’t use routers inside a LAN</u></p>
<p><em>Doesn’t mean there isn’t an IP layer !</em></p></li>
</ol>
<p>Terminology :</p>
<ul>
<li><em>host</em> = system that does not forward</li>
<li><em>packet</em> = IP data unit</li>
<li><em>intermediate system</em> = forwarding system</li>
</ul>
<h3 id="ipv4-addresses">2. IPv4 addresses</h3>
<ul>
<li>32 bits</li>
<li>UID (in principle)</li>
</ul>
<p>e.g. <code>128.191.151.1</code> (each integer is 8 bits)</p>
<p>Special addresses</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Address</th>
<th style="text-align: center;">usage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>0.0.0.0</code></td>
<td style="text-align: center;">absence of address</td>
</tr>
<tr class="even">
<td><code>127.0.0/24</code> (e.g. <code>127.0.0.1</code>)</td>
<td style="text-align: center;">this host = loopback address</td>
</tr>
<tr class="odd">
<td><code>10.0.0.0/8</code>, <code>172.16.0.0/12</code>, <code>192.168.0.0/16</code></td>
<td style="text-align: center;">private networks (cannot be used on the public internet)</td>
</tr>
<tr class="even">
<td><code>169.254.0.0/16</code></td>
<td style="text-align: center;">link local address (only between systems on a LAN)</td>
</tr>
<tr class="odd">
<td><code>224/4</code></td>
<td style="text-align: center;">multicast (one-to-many, like a group of hosts)</td>
</tr>
<tr class="even">
<td><code>240/5</code></td>
<td style="text-align: center;">reserved</td>
</tr>
<tr class="odd">
<td><code>255.255.255.255/32</code></td>
<td style="text-align: center;">link local broadcast</td>
</tr>
</tbody>
</table>
<figure>
<img src="img/5.png" alt="5" /><figcaption>5</figcaption>
</figure>
<p><u><em>Figure 4 :</em> The IPv4 Packet Format</u></p>
<blockquote>
<p><a href="https://www.youtube.com/watch?v=5Iyk7kFEUyQ">Week 2 - 2</a></p>
</blockquote>
<h3 id="ipv6-addresses">3. IPv6 addresses</h3>
<p>IPv6 redefines the packet format with a larger address space (128 bits <span class="math inline">\(\approx 4\)</span> Bn resses). It is incompatible with IPv4 : routers and hosts must handle both seperately. Its structure is hierarchical : often first half / prefix for host, with provider, the rest for a subnet and a client. i.e. we can aggregate addresses logically.</p>
<p>The TCP and MAC layers are not affected by the difference between IPv4/6 !</p>
<p>Compression rules :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">uncompressed</th>
<th style="text-align: center;">compressed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>2002:0000:0000:0000:0000:ffff:80b2:0c26</code></td>
<td style="text-align: center;"><code>2002::ffff:80b2:c26</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>2001:0620:0618:01a6:0000:20ff:fe78:30f9</code></td>
<td style="text-align: center;"><code>2001:620:618:1a6:0:20ff:fe78:30f9</code></td>
</tr>
</tbody>
</table>
<p>Special addresses :</p>
<table>
<thead>
<tr class="header">
<th>Address</th>
<th style="text-align: center;">Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>::/128</code></td>
<td style="text-align: center;">Absence of address</td>
</tr>
<tr class="even">
<td><code>::1/128</code></td>
<td style="text-align: center;">localhost</td>
</tr>
<tr class="odd">
<td><code>fc00::/7</code> (i.e. <code>fcxx:</code> and <code>fdxx:</code>)</td>
<td style="text-align: center;">Unique local addresses = private networks</td>
</tr>
<tr class="even">
<td><code>fe80::/10</code></td>
<td style="text-align: center;">link local address (on the same LAN)</td>
</tr>
<tr class="odd">
<td><code>ff00::/8</code></td>
<td style="text-align: center;">multicast</td>
</tr>
<tr class="even">
<td><code>ff02::1:ff00:0/104</code></td>
<td style="text-align: center;">solicited node multicast</td>
</tr>
<tr class="odd">
<td><code>ff02::1/128</code> , <code>ff02::2/128</code></td>
<td style="text-align: center;">link local broadcast</td>
</tr>
</tbody>
</table>
<figure>
<img src="img/6.png" alt="6" /><figcaption>6</figcaption>
</figure>
<p><u><em>Figure 5 :</em> IPv6 Packet Format</u></p>
<h3 id="nats">4. NATs</h3>
<p>NAT = Network Address Translation boxes</p>
<p>The goal is to reuse the same IP address for several devices, and use private addresses inside of a local network. This violates the TCP/IP architecture (since it mandates communication through a middleware even within a LAN). If there is a NAT the destination address of a packet is that of the NAT no ours (because it’s a private address).</p>
<p>It creates a NAT table which matches the source and destination with ports and IP address. This means it looks at two layers at the same time !</p>
<h3 id="subnets-and-masks">5. Subnets and Masks</h3>
<p>All hosts need to know on which LAN they are to know if they need IP or they can use MAC directly.</p>
<blockquote>
<p><a href="https://www.youtube.com/watch?v=SK2vAw19mRM">Week 3 - 1</a></p>
</blockquote>
<h3 id="host-configuration">6. Host Configuration</h3>
<p>An IP host needs to be configured on each interface with :</p>
<ul>
<li>IP address of the interface</li>
<li>Mask of the interface</li>
<li>IP address of the default router</li>
<li>IP address of the DNS server</li>
</ul>
<p>It can be done manually or automatically with <strong>DCHP</strong> (Dynamic Host Configuration Protocol). In IPv6 we can also have <em>stateful</em> or <em>stateless</em> DHCP, or <strong>SLAAC</strong>. Routers also need to be configured, usually though <strong>PPP</strong> or for IPv6 also DHCP with Prefix Delegation.</p>
<h4 id="dhcp">DHCP</h4>
<p>When a computer boots, it has no IP. It will broadcast a DHCP request on the network (<code>destination IP=255.255.255.255</code>), hoping there is a DHCP server or relay on the network, often a router *.</p>
<p>The address given has a ttl and can be renewed.</p>
<p>* On a small network, hosts connect directly to a DHCP server, but on larger ones we can have a relay which acts as an intermediary to the central DHCP server.</p>
<h4 id="ppp">PPP</h4>
<p>Same issue for a router (finding an IP). Very similar to DHCP.</p>
<h4 id="slaac">SLAAC</h4>
<p><em>StateLess Address Auto-Configuration</em></p>
<p>When you start on a network, likely that there is a router. So you can talk to this router that has been configured already. Since the IPv6 has a prefix + a host part, the router can already give you the prefix but not the host part. In IPv4 the host part is small so might be collisions, whereas in DHCP with 64 bits, we can just use (and pad) the MAC address as the host part.</p>
<ul>
<li>Step 1 : Determine a 64 bit host from manual assignement (e.g. <code>::1</code>), deriving it from the MAC address (most common), assign it randomly, assign it cryptographically</li>
<li>Step 2 : Duplicate test (sending a Neighbour Sollicitation message, sent to the Solicited Nope Multicast Address pbtained by adding the last 24 bits / last 6 hex digits of the target IP address to <code>ff02::1:ff00:0/104</code>)</li>
<li>Step 3 : Get the network prefix</li>
</ul>
<figure>
<img src="img/7.png" alt="7" /><figcaption>7</figcaption>
</figure>
<p><u><em>Figure 6 :</em> Deriving IP address from MAC</u></p>
<p>To avoid MAC address pinning, Randomly Assigned Host Part is used, which is rotated every few hours. This means we can have several IPv6 addresses ! (it already has two with the link local and global address)</p>
<p>Problem : SLAAC doesn’t give the DNS server address. Solution : get the router to return it, or use stateless DHCP.</p>
<h4 id="stateless-dhcp">Stateless DHCP</h4>
<p>Stateless doesn’t require a memory of state (for example a table of valid addresses, …). To do this, stateless auto-configuration (like SLAAC) is performed, then the host sends a query to the DHCP server to obtain the missing information such as the DNS server address (this is state, but does not depend on the host state).</p>
<h4 id="dhcp-with-prefix-delegation">DHCP with Prefix Delegation</h4>
<p>Used if the router has IPv6 available and needs to configure the IPv6 prefix for the entire block of addresses it is responsible for (e.g. a home network). The ISP’s DHCP server (called a <strong>delegating router</strong>) give the router the prefix it assigns it, which can then configure the hosts (e.g. with SLAAC).</p>
<h3 id="arp">7. ARP</h3>
<p>Mac Address Resolution problem : a host needs to know the <em>next-hop</em>’s MAC address (even though it already knows its IP address). To do this, A sends an address resolution packet (a neighbour solicitation (NS) with the Neighbour Discovery Protocol (NDP) protocol) on the LAN. The ones with the IP address of the desired machine (the next-hop) will respond with their MAC.</p>
<blockquote>
<p><a href="https://www.youtube.com/watch?v=0YB-1sPhfT8">Week 3 - 2</a></p>
</blockquote>
<p>Same idea as the duplication test with a multicast address, from which the MAC address can then be algorithmically derived.</p>
<p>The MAC address is then stored in an ARP Table / neighbour cache, which is refreshed whenever A receives a packet from B.</p>
<p>In IPv4, the ARP packet is <em>broadcast</em> (whereas in IPv6 where we use multicast) as an Ethernet frame.</p>
<h3 id="ip-packet-format-hl-and-ttl">8. IP packet format, HL and TTL</h3>
<p>HL / TTL avoid looping packets congesting the line. It is implemented as an 8 bit field ($ $) that is decremented at every hop. When it reaches 0, the packet is discarded so most router kill packets if it has TTL = 1 (and sends an error with ICMP). Default value : 64.</p>
<p>Other fields :</p>
<ul>
<li>Type of service / Traffic class (congestion control, priority levels)</li>
<li>Total length / Payload length (in bytes incl. header)</li>
<li>Protocol identification</li>
<li>Checksum (only IPv4)</li>
</ul>
</body>
</html>
