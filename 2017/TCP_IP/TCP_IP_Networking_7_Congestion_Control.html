<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>TCP_IP_Networking_7_Congestion_Control</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style type="text/css">
  @font-face {
    font-family: octicons-link;
    src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
  }
  
  body {
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
    color: #333;
    font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    font-size: 16px;
    line-height: 1.6;
    word-wrap: break-word;
    width: 728px;
    max-width: 99%;
    box-sizing: border-box;
    padding: 30px 30px 8rem 30px;
    margin-left: auto;
    margin-right: auto;
  }
  
  body a {
    background-color: transparent;
  }
  
  body a:active,
  body a:hover {
    outline: 0;
  }
  
  body strong {
    font-weight: bold;
  }
  
  body h1 {
    font-size: 2em;
    margin: 0.67em 0;
  }
  
  body img {
    border: 0;
  }
  
  body hr {
    box-sizing: content-box;
    height: 0;
  }
  
  body pre {
    overflow: auto;
  }
  
  body code,
  body kbd,
  body pre {
    font-family: monospace, monospace;
    font-size: 1em;
  }
  
  body input {
    color: inherit;
    font: inherit;
    margin: 0;
  }
  
  body html input[disabled] {
    cursor: default;
  }
  
  body input {
    line-height: normal;
  }
  
  body input[type="checkbox"] {
    box-sizing: border-box;
    padding: 0;
  }
  
  body table {
    border-collapse: collapse;
    border-spacing: 0;
  }
  
  body td,
  body th {
    padding: 0;
  }
  
  body * {
    box-sizing: border-box;
  }
  
  body input {
    font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  }
  
  body a {
    color: #4078c0;
    text-decoration: none;
  }
  
  body a:hover,
  body a:active {
    text-decoration: underline;
  }
  
  body hr {
    height: 0;
    margin: 15px 0;
    overflow: hidden;
    background: transparent;
    border: 0;
    border-bottom: 1px solid #ddd;
  }
  
  body hr:before {
    display: table;
    content: "";
  }
  
  body hr:after {
    display: table;
    clear: both;
    content: "";
  }
  
  body h1,
  body h2,
  body h3,
  body h4,
  body h5,
  body h6 {
    margin-top: 15px;
    margin-bottom: 15px;
    line-height: 1.1;
  }
  
  body h1 {
    font-size: 30px;
  }
  
  body h2 {
    font-size: 21px;
  }
  
  body h3 {
    font-size: 16px;
  }
  
  body h4 {
    font-size: 14px;
  }
  
  body h5 {
    font-size: 12px;
  }
  
  body h6 {
    font-size: 11px;
  }
  
  body blockquote {
    margin: 0;
  }
  
  body ul,
  body ol {
    padding: 0;
    margin-top: 0;
    margin-bottom: 0;
  }
  
  body ol ol,
  body ul ol {
    list-style-type: lower-roman;
  }
  
  body ul ul ol,
  body ul ol ol,
  body ol ul ol,
  body ol ol ol {
    list-style-type: lower-alpha;
  }
  
  body dd {
    margin-left: 0;
  }
  
  body code {
    font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
    font-size: 12px;
  }
  
  body pre {
    margin-top: 0;
    margin-bottom: 0;
    font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  }
  
  body .select::-ms-expand {
    opacity: 0;
  }
  
  body .octicon {
    font: normal normal normal 16px/1 octicons-link;
    display: inline-block;
    text-decoration: none;
    text-rendering: auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
  
  body .octicon-link:before {
    content: '\f05c';
  }
  
  body:before {
    display: table;
    content: "";
  }
  
  body:after {
    display: table;
    clear: both;
    content: "";
  }
  
  body>*:first-child {
    margin-top: 0 !important;
  }
  
  body>*:last-child {
    margin-bottom: 0 !important;
  }
  
  body a:not([href]) {
    color: inherit;
    text-decoration: none;
  }
  
  body .anchor {
    display: inline-block;
    padding-right: 2px;
    margin-left: -18px;
  }
  
  body .anchor:focus {
    outline: none;
  }
  
  body h1,
  body h2,
  body h3,
  body h4,
  body h5,
  body h6 {
    margin-top: 1em;
    margin-bottom: 16px;
    font-weight: bold;
    line-height: 1.4;
  }
  
  body h1 .octicon-link,
  body h2 .octicon-link,
  body h3 .octicon-link,
  body h4 .octicon-link,
  body h5 .octicon-link,
  body h6 .octicon-link {
    color: #000;
    vertical-align: middle;
    visibility: hidden;
  }
  
  body h1:hover .anchor,
  body h2:hover .anchor,
  body h3:hover .anchor,
  body h4:hover .anchor,
  body h5:hover .anchor,
  body h6:hover .anchor {
    text-decoration: none;
  }
  
  body h1:hover .anchor .octicon-link,
  body h2:hover .anchor .octicon-link,
  body h3:hover .anchor .octicon-link,
  body h4:hover .anchor .octicon-link,
  body h5:hover .anchor .octicon-link,
  body h6:hover .anchor .octicon-link {
    visibility: visible;
  }
  
  body h1 {
    padding-bottom: 0.3em;
    font-size: 1.75em;
    line-height: 1.2;
  }
  
  body h1 .anchor {
    line-height: 1;
  }
  
  body h2 {
    padding-bottom: 0.3em;
    font-size: 1.5em;
    line-height: 1.225;
  }
  
  body h2 .anchor {
    line-height: 1;
  }
  
  body h3 {
    font-size: 1.25em;
    line-height: 1.43;
  }
  
  body h3 .anchor {
    line-height: 1.2;
  }
  
  body h4 {
    font-size: 1em;
  }
  
  body h4 .anchor {
    line-height: 1.2;
  }
  
  body h5 {
    font-size: 1em;
  }
  
  body h5 .anchor {
    line-height: 1.1;
  }
  
  body h6 {
    font-size: 1em;
    color: #777;
  }
  
  body h6 .anchor {
    line-height: 1.1;
  }
  
  body p,
  body blockquote,
  body ul,
  body ol,
  body dl,
  body table,
  body pre {
    margin-top: 0;
    margin-bottom: 16px;
  }
  
  body hr {
    height: 4px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
  }
  
  body ul,
  body ol {
    padding-left: 2em;
  }
  
  body ul ul,
  body ul ol,
  body ol ol,
  body ol ul {
    margin-top: 0;
    margin-bottom: 0;
  }
  
  body li>p {
    margin-top: 16px;
  }
  
  body dl {
    padding: 0;
  }
  
  body dl dt {
    padding: 0;
    margin-top: 16px;
    font-size: 1em;
    font-style: italic;
    font-weight: bold;
  }
  
  body dl dd {
    padding: 0 16px;
    margin-bottom: 16px;
  }
  
  body blockquote {
    padding: 0 15px;
    color: #777;
    border-left: 4px solid #ddd;
  }
  
  body blockquote>:first-child {
    margin-top: 0;
  }
  
  body blockquote>:last-child {
    margin-bottom: 0;
  }
  
  body table {
    display: block;
    width: 100%;
    overflow: auto;
    word-break: normal;
    word-break: keep-all;
  }
  
  body table th {
    font-weight: bold;
  }
  
  body table th,
  body table td {
    padding: 6px 13px;
    border: 1px solid #ddd;
  }
  
  body table tr {
    background-color: #fff;
    border-top: 1px solid #ccc;
  }
  
  body table tr:nth-child(2n) {
    background-color: #f8f8f8;
  }
  
  body img {
    max-width: 100%;
    box-sizing: content-box;
    background-color: #fff;
  }
  
  body code {
    padding: 0;
    padding-top: 0;
    padding-bottom: 0;
    margin: 0;
    font-size: 85%;
    background-color: rgba(0,0,0,0.04);
    border-radius: 3px;
  }
  
  body code:before,
  body code:after {
    letter-spacing: -0.2em;
    content: "\00a0";
  }
  
  body pre>code {
    padding: 0;
    margin: 0;
    font-size: 100%;
    word-break: normal;
    white-space: pre;
    background: transparent;
    border: 0;
  }
  
  body .highlight {
    margin-bottom: 16px;
  }
  
  body .highlight pre,
  body pre {
    padding: 16px;
    overflow: auto;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border-radius: 3px;
  }
  
  body .highlight pre {
    margin-bottom: 0;
    word-break: normal;
  }
  
  body pre {
    word-wrap: normal;
  }
  
  body pre code {
    display: inline;
    max-width: initial;
    padding: 0;
    margin: 0;
    overflow: initial;
    line-height: inherit;
    word-wrap: normal;
    background-color: transparent;
    border: 0;
  }
  
  body pre code:before,
  body pre code:after {
    content: normal;
  }
  
  body kbd {
    display: inline-block;
    padding: 3px 5px;
    font-size: 11px;
    line-height: 10px;
    color: #555;
    vertical-align: middle;
    background-color: #fcfcfc;
    border: solid 1px #ccc;
    border-bottom-color: #bbb;
    border-radius: 3px;
    box-shadow: inset 0 -1px 0 #bbb;
  }
  
  body .pl-c {
    color: #969896;
  }
  
  body .pl-c1,
  body .pl-s .pl-v {
    color: #0086b3;
  }
  
  body .pl-e,
  body .pl-en {
    color: #795da3;
  }
  
  body .pl-s .pl-s1,
  body .pl-smi {
    color: #333;
  }
  
  body .pl-ent {
    color: #63a35c;
  }
  
  body .pl-k {
    color: #a71d5d;
  }
  
  body .pl-pds,
  body .pl-s,
  body .pl-s .pl-pse .pl-s1,
  body .pl-sr,
  body .pl-sr .pl-cce,
  body .pl-sr .pl-sra,
  body .pl-sr .pl-sre {
    color: #183691;
  }
  
  body .pl-v {
    color: #ed6a43;
  }
  
  body .pl-id {
    color: #b52a1d;
  }
  
  body .pl-ii {
    background-color: #b52a1d;
    color: #f8f8f8;
  }
  
  body .pl-sr .pl-cce {
    color: #63a35c;
    font-weight: bold;
  }
  
  body .pl-ml {
    color: #693a17;
  }
  
  body .pl-mh,
  body .pl-mh .pl-en,
  body .pl-ms {
    color: #1d3e81;
    font-weight: bold;
  }
  
  body .pl-mq {
    color: #008080;
  }
  
  body .pl-mi {
    color: #333;
    font-style: italic;
  }
  
  body .pl-mb {
    color: #333;
    font-weight: bold;
  }
  
  body .pl-md {
    background-color: #ffecec;
    color: #bd2c00;
  }
  
  body .pl-mi1 {
    background-color: #eaffea;
    color: #55a532;
  }
  
  body .pl-mdr {
    color: #795da3;
    font-weight: bold;
  }
  
  body .pl-mo {
    color: #1d3e81;
  }
  
  body kbd {
    display: inline-block;
    padding: 3px 5px;
    font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
    line-height: 10px;
    color: #555;
    vertical-align: middle;
    background-color: #fcfcfc;
    border: solid 1px #ccc;
    border-bottom-color: #bbb;
    border-radius: 3px;
    box-shadow: inset 0 -1px 0 #bbb;
  }
  
  body .task-list-item {
    list-style-type: none;
  }
  
  body .task-list-item+.task-list-item {
    margin-top: 3px;
  }
  
  body .task-list-item input {
    margin: 0 0.35em 0.25em -1.6em;
    vertical-align: middle;
  }
  
  body :checked+.radio-label {
    z-index: 1;
    position: relative;
    border-color: #4078c0;
  }
  </style>
</head>
<body>
<h1 id="tcpip-networking">TCP/IP Networking</h1>
<h2 id="congestion-control">Congestion Control</h2>
<ul>
<li>Book : <em>Rate adapation, Congestion Control &amp; Fairness</em>, JYLB</li>
<li>slides : <code>cc.pdf</code></li>
</ul>
<h2 id="what-is-the-problem-congestion-collapse">1. What is the problem; congestion collapse</h2>
<p>If loss is proportional to submitted traffic and sources are greedy then the rate drops very quickly :</p>
<p>Accepted traffic at <span class="math inline">\(C_1\)</span> : <span class="math inline">\(\frac{110}{100+1000} = 10\%\)</span></p>
<p>Accepted traffic at <span class="math inline">\(C_4\)</span> : <span class="math inline">\(100\%\)</span></p>
<p>Accepted traffic at <span class="math inline">\(C_5\)</span> : $ = 10% $</p>
<p>Both sources only send at 10 kb/s …</p>
<figure>
<img src="img/31.png" alt="31" /><figcaption>31</figcaption>
</figure>
<h4 id="example-topology">Example topology</h4>
<p>Source <span class="math inline">\(i\)</span> uses 2 links, all of same capacity <span class="math inline">\(c\)</span>. At every node there is a source, all of them have the same rate.</p>
<p>If <span class="math inline">\(\lambda &lt; \frac{c}{2}\)</span> there is no loss (and <span class="math inline">\(\lambda = \lambda^{&#39;&#39;}\)</span>)</p>
<p>If <span class="math inline">\(\lambda &gt; \frac{c}{2}\)</span> there is loss :</p>
<ul>
<li>The rate of accepted traffic at one node is <span class="math inline">\(\frac{c}{\lambda+\lambda^{&#39;}}\)</span></li>
<li>We get <span class="math inline">\(\lambda^{&#39;&#39;} = c - \lambda (-1 + \sqrt{1+\frac{4c}{\lambda}})\)</span></li>
</ul>
<figure>
<img src="img/32.png" alt="32" /><figcaption>32</figcaption>
</figure>
<p><img src="img/33.png" alt="33" />The congestion collapse is <span class="math inline">\(\tilde{} \frac{1}{\lambda}\)</span> . As the offered load increases, the total throughput decreases</p>
<h2 id="efficiency-versus-fairness">2. Efficiency versus Fairness</h2>
<h4 id="pareto-efficiency">Pareto efficiency</h4>
<p>A feasible allocation of rates is called Pareto-efficient iff increasing one source must be at the expense of decreasing some other source.</p>
<p><span class="math inline">\(\vec{x}\)</span> is Pareto-efficient iff for any other $^{‘}, i : x^{’}_{i} &gt; x_i j : x_j^{’} &lt; x_j $</p>
<p>Doesn’t mean the allocation is fair.</p>
<h2 id="definitions-of-fairness">3. Definitions of fairness</h2>
<h4 id="egalitarianism">Egalitarianism</h4>
<p>Not Pareto efficient.</p>
<h4 id="max-min-fair">Max-Min fair</h4>
<p>Give everyone at least as much as egalitarianism.</p>
<p>For any source <span class="math inline">\(i\)</span> increasing the rate <span class="math inline">\(i\)</span> must force the rate of some other (not richer) source <span class="math inline">\(j\)</span> to decrease. In other words: an allocation is max‐min fair if any rate increase contradicts fairness.</p>
<p>If it exists, it is <strong>unique</strong>. Existence is guaranteed if the set of feasible rates is convex (this is the case for networks). The allocation is Pareto efficient.</p>
<h4 id="proportional-fairness">Proportional fairness</h4>
<p>An allocation is proportionally fair if any change contradicts proportional fairness in the sense that the total / average rate of change <span class="math inline">\(\sum_i \frac{\Delta x_i}{x_i}\)</span> is negative.</p>
<p>This means that relative shares matter. Given a set of convex constraints, the proportionally fair allocation <em>exists</em> and is <em>unique</em>. It is obtained by maximizing <span class="math inline">\(\sum_i log(x_i)\)</span>. It is Pareto efficient.</p>
<h4 id="utility-fairness">Utility fairness</h4>
<p>One can interpret proportional fairness as the allocation that maximizes a global utility. The utility of an allocation is here the log of the rate. It can be shown that max‐min fairness is the limit of utility fairness when the utility function converges to a step function</p>
<h2 id="additive-increase-multiplicative-decrease-aimd">4. Additive Increase Multiplicative Decrease (AIMD)</h2>
<p>The network sends a 1 bit feedback :</p>
<figure>
<img src="img/34.png" alt="34" /><figcaption>34</figcaption>
</figure>
<p><span class="math display">\[ y(t) = \begin{cases} 0 \text{ if } \sum_i x_i(t) \le c \\ 1 \text{else }  \end{cases}\]</span></p>
<p>Source will reduce rate if <span class="math inline">\(y(t) = 1\)</span>, increases it otherwise.</p>
<h4 id="linear-laws">Linear Laws</h4>
<ul>
<li>if <span class="math inline">\(y(t) = 1\)</span> then <span class="math inline">\(x_i(t+1) = u_1 x_i(t) + v_1\)</span>
<ul>
<li>Decrease : <span class="math inline">\(u_1 \le 1\)</span> and <span class="math inline">\(v_1 \le 0\)</span></li>
</ul></li>
<li>if <span class="math inline">\(y(t) = 0\)</span> then <span class="math inline">\(x_i(t+1) = u_ 0x_i(t) + v_0\)</span>
<ul>
<li>Increase : <span class="math inline">\(u_0 \ge 1\)</span> and <span class="math inline">\(v_0 \ge 0\)</span></li>
</ul></li>
</ul>
<figure>
<img src="img/35.png" alt="35" /><figcaption>35</figcaption>
</figure>
<p>The fairness of AIMD is between maxmin fairness and proportional fairness, closer to proportional fairness.</p>
<h2 id="slow-start">5. Slow start</h2>
<p>Added to AIMD : used at beginning of connection and at losses detected by timeout.</p>
<p>The idea is to increase the rate multiplicatively until a target rate is reached or a negative feedback is received. Apply multiplicative decrease to target rate if negative feedback is received. Exit slow start when target rate is reached.</p>
<figure>
<img src="img/36.png" alt="36" /><figcaption>36</figcaption>
</figure>
<h2 id="tcp-reno">6. TCP Reno</h2>
<p>Congestion control is in TCP :</p>
<ul>
<li>TCP sources adjust their window to the congestion status of the Internet. They interpret losses as a negative feedback (loss of packet)</li>
<li>UDP sorces have to implement their own congestion control. Some UDP sources imitate UDP (TCP friendly)</li>
</ul>
<p>TCP adjusts the window size based on the approximate rate <span class="math inline">\(\approx \frac{W}{RTT}\)</span>. where <span class="math inline">\(W\)</span> = <span class="math inline">\(min(\)</span>window obtained by Cong. Control, window field<span class="math inline">\()\)</span>.</p>
<p>Reno uses ~AIMD and Slow Start.</p>
<ul>
<li>When loss is detected by timeout : slow start.</li>
<li>When loss is detected by fast retransmit (3 duplicate ACKs) : fast recovery (half the target window, but congestion window is allowed to increase beyond the target window until the loss is repaired)</li>
<li>Multiplicative Decrease : ssthresh = 0.5*cwnd</li>
<li>Additive Increase : for every ACK received cwnd += MSS*MSS / cwnd (MSS = max segment size)</li>
</ul>
<figure>
<img src="img/37.png" alt="37" /><figcaption>37</figcaption>
</figure>
<blockquote>
<p>At time 1, the sender is in “congestion avoidance” mode. The congestion window increases with every received non‐duplicate ack (as at time 6). The target window (ssthresh) is equal to the congestion window.</p>
<p>The second packet is lost.</p>
<p>At time 12, its loss is detected by fast retransmit, i.e. reception of 3 duplicate acks. The sender goes into “fast recovery” mode. The target window is set to half the value of the congestion window; the congestion window is set to the target window plus 3 packets (one for each duplicate ack received).</p>
<p>At time 13 the source retransmits the lost packet. At time 14 it transmits a fresh packet. This is possible because the window is large enough. The window size, which is the minimum of the congestion window and the advertised window, is equal to 707. Since the last acked byte is 201, it is possible to send up to 907.</p>
<p>At times 15, 16 and 18, the congestion window is increased by 1 MSS, i.e. 100 bytes, by application of the congestion avoidance algorithm. At time 15, this allows to send one fresh packet, which occurs at time 17.</p>
<p>At time 18 the lost packet is acked, the source exits the fast recovery mode and enters congestion avoidance. The congestion window is set to the target window.</p>
</blockquote>
<figure>
<img src="img/38.png" alt="38" /><figcaption>38</figcaption>
</figure>
<p>Fairness ~ Utility fairness <span class="math inline">\(U(x_i) = \frac{\sqrt{2}}{\tau_i} arctan \frac{x_i \tau_i}{\sqrt{2}}\)</span> <span class="math inline">\(x_i = \frac{W}{\tau_i} =\)</span> rate.</p>
<p>For sources that have same RTT, the fairness of TCP is between maxmin fairness and proportional fairness, closer to proportional fairness.</p>
<p>Source with large RTT obtains less. A source that uses many hops obtains less rate because of two combined factors, one is good, the other is bad:</p>
<ol type="1">
<li>this source uses more resources. The mechanics of proportional fairness leads to this source having less rate – this is desirable in view of the theory of fairness.</li>
<li>this source has a larger RTT. The mechanics of additive increase leads to this source having less rate – this is an undesired bias in the design of TCP Reno</li>
</ol>
<h4 id="loss-throughput-formula">Loss-Throughput Formula</h4>
<p>For a large TCP connection, we observe that a fraction <span class="math inline">\(q\)</span> of packets is lost.</p>
<p><span class="math inline">\(\theta = \frac{1.22 \cdot MSS}{RTT \cdot \sqrt{q}}\)</span></p>
<p>Formula assumes that TT is negligeable wrt RTT, losses are rare, …</p>
<h2 id="tcp-cubic">7. TCP Cubic</h2>
<h4 id="long-fat-networks-lfn">Long Fat Networks (LFN)</h4>
<p>In an LFN, additive increase is too slow. TCP Cubic keeps the same slow start, congestion avoidance, fast recovery phases as TCP Reno, but:</p>
<ul>
<li>Multiplicative Decrease is 0.7 (instead of 0.5)</li>
<li>During congestion avoidance, the increase is not additive but cubic</li>
</ul>
<figure>
<img src="img/39.png" alt="39" /><figcaption>39</figcaption>
</figure>
<ul>
<li>Cubic’s window <span class="math inline">\(\ge\)</span> AIMD’s window.</li>
<li>Cubic’s throughput <span class="math inline">\(\ge\)</span> Reno′ throughput ( <span class="math inline">\(=\)</span> when RTT or bandwidth‐delay product is small)</li>
</ul>
<h2 id="ecn-and-red">8. ECN and RED</h2>
<p>Solves the problem of forming large bottleneck buffers when increasing the amount of inflight data.</p>
<h4 id="explicit-congestion-notification-ecn">Explicit Congestion Notification (ECN)</h4>
<p>router marks packet instead of dropping TCP destination echoes the mark back to source At the source, TCP interprets a marked packet in the same way as if there would be a loss detected by fast retransmit.</p>
<ul>
<li>2 bits in IP header (direct path) code for 4 possible codepoints
<ul>
<li>non ECN Capable (non ECT)</li>
<li>ECN capable and no congestion ECT(0) and ECT(1)</li>
<li>ECN capable and congestion experienced (CE)</li>
</ul></li>
<li>3 bits in TCP header (return path)</li>
<li>Nonce Sum bit in TCP header (NS) is used by S to verify that ECN works for this TCP</li>
</ul>
<h4 id="random-early-detection-red">Random Early Detection (RED)</h4>
<p><em>Solves how to mark a packet with ECN</em></p>
<ul>
<li>queue estimates its average queue length : <span class="math inline">\(avg \leftarrow a \cdot measured + (1-a) \cdot avg\)</span></li>
<li>incoming packet is marked with probability given by RED curve</li>
</ul>
<p>Active Queue Management : RED can also be applied even if ECN is not supported In such a case, a packet is dropped with proba q computed by the RED curver packet may be discarded even if there is some space available ! (this should help avoid constantly full buffers, avoid irregular drop patterns)</p>
<h2 id="other-cool-stuff">9. Other Cool Stuff</h2>
<h3 id="datacenter-tcp">Datacenter TCP</h3>
<ul>
<li>most traffic is TCP</li>
<li>very small latencies (10‐100 s)</li>
<li>lots of bandwidth, lots of traffic</li>
<li>internal traffic (distributed computing) and external (user requests and their responses)</li>
<li>many short flows with low latency required (user queries, mapReduce communication)</li>
<li>some jumbo flows with huge volume (backup, synchronizations) may use an entire link</li>
</ul>
<p>Used to improve performance when ECN is used. Avoid the brutal multiplicative increase by 50%. TCP source estimation congestion probability <span class="math inline">\(p\)</span>, and set the multiplicative decrease to <span class="math inline">\(\beta_{DCTCP} = (1 - \frac{p}{2})\)</span>. ECN echo is modified so that the proportion of CE marked Acks the probability of congestion</p>
<h3 id="class-based-queuing">Class Based Queuing</h3>
<p>In controlled environments (e.g. a data center, a smart grid, a TV distribution network, a cellular network) it is possible to modify the competition by using per‐flow or class‐based queuing :</p>
<ul>
<li>routers classify packets (access list)</li>
<li>each class is guaranteed a rate</li>
<li>classes may exceed the guaranteed rate by borrowing from other classes if there is spare capacity</li>
</ul>
<h3 id="tcp-friendly">TCP Friendly</h3>
<ul>
<li><p>Some UDP applications that can adapt their rate (e.g. VBR video) have to implement congestion control; one method is to use integrate the congestion control module of TCP: e.g. QUIC, which is over UDP, uses Cubic’s congestion control</p></li>
<li><p>Another method is to rate control by computing the rate that TCP Reno would obtain. E.g.: TFRC (TCP‐Friendly Rate Control) protocol</p>
<ul>
<li><p>application determines the sending rate (hence coding rate for</p>
<p>audio and video)</p></li>
<li><p>feedback is received in form of count of lost packets</p></li>
<li><p>sending rate is set to: rate of a TCP flow experiencing the same loss</p>
<p>ratio, using the loss throughput formula</p></li>
</ul></li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<ul>
<li>Congestion control is in TCP or in a TCP‐friendly UDP application.</li>
<li>Standard TCP uses the window to control the amount of traffic: additive increase or cubic (as long as no loss); multiplicative decrease (following a loss).</li>
<li>Standard TCP uses loss as congestion signal.</li>
<li>Too much buffer is as bad as too little buffer – bufferbloat provokes large latency for interactive flows.</li>
<li>ECN can be used to avoid bufferbloat – it replaces loss by an explicitc congestion signal; not widely deployed in the internet, but is in Data Center TCP.</li>
<li>Class based queuing is used to separate flows in enterprise networks.</li>
</ul>
</body>
</html>
